<mvc:View
	controllerName="projectX.view.Sequence.Sequence"
	xmlns:mvc="sap.ui.core.mvc"
	xmlns:l="sap.ui.layout"
	xmlns:f="sap.ui.layout.form"
	xmlns:c="sap.ui.core"
	xmlns="sap.m">
	<Page
		showHeader="false"
		enableScrolling="true"
		title="{localUIModel>/reason}">
		<subHeader>
		<Toolbar>
			<SegmentedButton selectedButton="idButtonConfig"
							select="onSegmentedButtonSelect">
			<Button text="Config" id="idButtonConfig" />
			<Button text="Testrun" id="idButtonTest" />
			</SegmentedButton>
			<ToolbarSpacer/>
			<Button text="Clear"
					press="onClearResults"
					visible="{localUIModel>/testNotRunning}"
					/>
			<Button text="Run Sequence"
					press="onRunSequence"
					visible="{localUIModel>/testNotRunning}"/>
			<Button text="Stop"
					type="Emphasized"
					press="onStopSequence"
					visible="{localUIModel>/testRunning}"
					/>
		</Toolbar>
		</subHeader>

		<ScrollContainer
			visible="{localUIModel>/configVisible}"
			height="100%"
			width="100%"
			horizontal="false"
			vertical="true">
			<l:Grid
				defaultSpan="L12 M12 S12"
				width="auto">
				<l:content>
					<f:SimpleForm
						editable="true"
						layout="ResponsiveGridLayout">
						<f:content>
							<!-- Basic info -->
							<c:Title text="Sequence Info" />
							<Label text="Name" />
							<Input value="{localUIModel>/sequence/mProperties/name}"
									liveChange="onNameChanged"
									valueLiveUpdate="true"
									/>
							<Label text="Description" />
							<Input value="{localUIModel>/sequence/mProperties/description}" />
						</f:content>
					</f:SimpleForm>
				</l:content>
			</l:Grid>
			<FlexBox
				width="100%"
				alignItems="Stretch">
				<VBox>
					<layoutData>
						<FlexItemData growFactor="1" />
					</layoutData>
					<Label text="Available Requests"/>
					<List
						id="idListRequests"
						items="{localUIModel>/requests}"
						mode="MultiSelect"
						select="onRequestsListSelect">
						<items>
							<StandardListItem title="{localUIModel>mProperties/name}"/>
						</items>
					</List>
				</VBox>

				<VBox justifyContent="Start">
					<layoutData>
						<FlexItemData shrinkFactor="0" />
					</layoutData>
					<Button icon="sap-icon://arrow-right" press="onButtonRight"/>
					<Button icon="sap-icon://arrow-left" press="onButtonLeft"/>
				</VBox>

				<VBox>
					<layoutData>
						<FlexItemData growFactor="1" />
					</layoutData>
					<Label text="Selected Requests"/>
					<List
						id="idListSelectedRequests"
						items="{localUIModel>/selectedRequests}"
						mode="MultiSelect"
						select="onSelectedRequestsListSelect">
						<items>
							<StandardListItem title="{localUIModel>mProperties/name}"/>
						</items>
					</List>
					<HBox justifyContent="End">
						<Button icon="sap-icon://up" press="onMoveRequestUp"/>
						<Button icon="sap-icon://down" press="onMoveRequestDown"/>
					</HBox>
				</VBox>
			</FlexBox>
		</ScrollContainer>

		<ScrollContainer
			visible="{localUIModel>/testVisible}"
			height="100%"
			width="100%"
			horizontal="true"
			vertical="true" >
			<Table
				items="{localUIModel>/selectedRequests}">
				<columns>
				<Column
					>
					<Text text="Request" />
				</Column>
					<Column
					width="5em">
					<Text text="Assertions" />
					</Column>
				<Column
					hAlign="Right"
					width="3em">
					<Text text="Status" />
				</Column>
					<Column
					width="3em">
						<Text text="Time" />
					</Column>
				</columns>
				<items>
				<ColumnListItem vAlign="Top">
					<cells>
						<VBox>
						<ObjectIdentifier
							title="{localUIModel>mProperties/name}"
							text="{localUIModel>mProperties/url}"
							titleActive="true"
							titlePress="onRequestNamePress"/>
							<!-- TODO script exceptions / script input variables -->
							<TextArea value="{localUIModel>mProperties/scriptCode}"
										placeholder="no script code supplied"
										editable="false"
										rows="6"
										class="invisible visibleWhenExpanded"/>
							<TextArea value="{localUIModel>mProperties/responseHeaders}"
										placeholder="response headers will be filled after running the sequence..."
										editable="false"
										rows="6"
										class="invisible visibleWhenExpanded"/>
							<TextArea value="{localUIModel>mProperties/responseBody}"
										placeholder="response body will be filled after running the sequence..."
										editable="false"
										rows="6"
										class="invisible visibleWhenExpanded"/>
						</VBox>
						<c:Icon
							src="{ parts : [
								{ path : 'localUIModel>mProperties/assertionsResult' },
								{ path : 'localUIModel>mProperties/assertionsResultReady' }
							],
							formatter : 'projectX.util.Formatter.assertionsResultToImage' }"/>
						<Text text="{localUIModel>mProperties/status}"/>
						<Text text="{localUIModel>mProperties/responseTime}"/>
					</cells>
				</ColumnListItem>
				</items>
			</Table>
		</ScrollContainer>


		<footer>
			<Toolbar>
				<ToolbarSpacer/>
				<Button text="Clear"
						press="onClearResults"
						/>
				<Button text="Run Sequence"
						type="Emphasized"
						press="onRunSequence"
						visible="{localUIModel>/testNotRunning}"
						/>
				<Button text="Stop"
						type="Emphasized"
						press="onStopSequence"
						visible="{localUIModel>/testRunning}"
						/>
				<Button text="Create"
						type="Emphasized"
						press="onCreate"
						visible="{localUIModel>/reasonNew}"/>
				<Button press="onBtnDeletePress" 
						text="Delete"
						icon="sap-icon://delete"/>
			</Toolbar>
		</footer>
	</Page>
</mvc:View>
