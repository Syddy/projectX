<mvc:View
        controllerName="projectX.view.Request.Request"
        xmlns:mvc="sap.ui.core.mvc"
        xmlns:core="sap.ui.core"
        xmlns:l="sap.ui.layout"
        xmlns:f="sap.ui.layout.form"
        xmlns="sap.m"
        xmlns:u="sap.ui.unified"
        xmlns:html="http://www.w3.org/1999/xhtml"
        xmlns:custom="projectX.util">
    <Page showNavButton="{device>/isPhone}"
          navButtonPress="onNavBack"
          enableScrolling="false"
          showHeader="false"
          title="{localUIModel>/name}">
        <subHeader>
            <Toolbar>
              <Label text=" {localUIModel>/request/mProperties/sapStatistics}"/>
              <ToolbarSpacer/>
              <Label text="Status: {localUIModel>/request/mProperties/status}
              Time: {localUIModel>/request/mProperties/responseTime}ms"/>
              <Button text="Send Request"
                      press="onBtnSendPress"
                      type="Emphasized"/>
            </Toolbar>
        </subHeader>

        <content>

            <ScrollContainer
                    visible="{localUIModel>/requestVisible}"
                    height="100%"
                    width="100%"
                    horizontal="false"
                    vertical="true">

                <l:Grid
    				defaultSpan="L12 M12 S12"
    				width="auto">
    				<l:content>
    					<f:SimpleForm
    						editable="true"
    						layout="ResponsiveGridLayout">
    						<f:content>						
    							<Label text="Name" />
                                <Input value="{localUIModel>/request/mProperties/name}"
                                       placeholder="name of request"
                                       liveChange="onNameChanged"
                                       valueLiveUpdate="true"
                                        />
                                <Label text="HTTP Method" />
                                <Select selectedKey="{localUIModel>/request/mProperties/httpMethod}"
                                        items="{localUIModel>/HTTP_METHODS}"
                                        width="150px">
                                    <core:Item text="{localUIModel>key}" key="{localUIModel>key}"/>
                                </Select>
                                <Label text="URL" />
                                <TextArea value="{localUIModel>/request/mProperties/url}"
                                          id="idTextAreaUrl"
                                          placeholder="Enter URL here ..."
                                          rows="5"
                                        />
    							<Label text="Use Project Prefix URL" />
                                <CheckBox text="{localUIModel>/project/mProperties/prefixUrl}"
                                          selected="{localUIModel>/request/mProperties/useProjectPrefixUrl}"
                                          select="onCBPrefixSelected"/>
                                <Label text="CSRF Token" />  
                                <CheckBox text="get CRSF token from {localUIModel>/project/mProperties/baseUrl}"
                                        selected="{localUIModel>/request/mProperties/fetchCSRFToken}"/>  
                                
    						</f:content>
    					</f:SimpleForm>
    				</l:content>
    			</l:Grid>
                
                <!-- REQUEST HEADER -->
                <Panel expandable="true"
                       expanded="false"
                       headerText="Request Headers ({localUIModel>/request/mAggregations/requestHeaders/length})"
                       class="sapUiNoContentPadding"
                        >
                    <VBox id="idVBoxRequestHeaderPlaceholder"/>
                </Panel>

                <!-- REQUEST PAYLOAD -->
                <Panel expandable="true"
                       expanded="false"
                       expand="onPanelRequestBodyExpand"
                       class="sapUiNoContentPadding"
                       >
                       <headerToolbar>
                         <Toolbar design="Transparent" height="3rem">
                          <Text text="Request Payload ({localUIModel>/request/mProperties/requestBody/length})"/>
                        </Toolbar>
                       </headerToolbar>
                    <custom:AceEditor width="100%" height="200px"
                                      value="{localUIModel>/request/mProperties/requestBody}"
                                      id="superEditorRequestBody"
                                      />
                </Panel>

                <!-- PRE-REQUEST SCRIPT -->
                <Panel expandable="true"
                       expanded="false"
                       expand="onPanelPrescriptExpand"
                       class="sapUiNoContentPadding"
                       >
                       <headerToolbar>
                         <Toolbar design="Transparent" height="3rem">
                          <Text text="Pre-Request Script ({localUIModel>/request/mProperties/scriptCode/length}) {localUIModel>/request/mProperties/preRequestScriptResult}"/>
                        </Toolbar>
                       </headerToolbar>
                    
                        <Button text="Snippets" press="onButtonScriptExamples"/>
                        <u:Menu items="{localUIModel>/SCRIPT_EXAMPLES}"
                                id="idMenuScriptExamples">
                            <u:MenuItem text="{localUIModel>text}"
                                        select="onMenuItemScriptExampleSelected"/>
                        </u:Menu>
                        <custom:AceEditor width="100%" height="200px"
                                          value="{localUIModel>/request/mProperties/scriptCode}"
                                          id="superEditor"
                                          />
                </Panel>
                
                <!-- ASSERTIONS -->
                <Panel expandable="true"
                       expanded="false"
                       class="sapUiNoContentPadding"
                       >
                       <headerToolbar>
                         <Toolbar design="Transparent" height="3rem">
                          <Text text="Assertions ({localUIModel>/request/mAggregations/assertions/length})"/>
                          <core:Icon src="{ parts : [
                            								{ path : 'localUIModel>/request/mProperties/assertionsResult' },
                            								{ path : 'localUIModel>/request/mProperties/assertionsResultReady' },
                                                            { path : 'localUIModel>/request/mAggregations/assertions/length'}
                            							],
                            							formatter : 'projectX.util.Formatter.assertionsListResultToImage' }"/>
                        </Toolbar>
                       </headerToolbar>
                  <VBox id="idVBoxAssertionPlaceholder"/>
                </Panel>

                <!-- TEST SCRIPT -->
                <Panel expandable="true"
                       expanded="false"
                       expand="onPanelTestExpand"
                       class="sapUiNoContentPadding"
                       >
                       <headerToolbar>
                         <Toolbar design="Transparent" height="3rem">
                          <Text text="Test Script ({localUIModel>/request/mProperties/testScriptCode/length}) {localUIModel>/request/mProperties/testScriptResult}"/>
                        </Toolbar>
                       </headerToolbar>
                    
                           <Button text="Snippets" press="onButtonTestScriptExamples"/>
                           <u:Menu items="{localUIModel>/TESTSCRIPT_EXAMPLES}"
                                   id="idMenuTestScriptExamples">
                               <u:MenuItem text="{localUIModel>text}"
                                           select="onMenuItemTestScriptExampleSelected"/>
                           </u:Menu>
                            <custom:AceEditor width="100%" height="200px"
                                              value="{localUIModel>/request/mProperties/testScriptCode}"
                                              id="superEditorTestScript"
                                              />
                            <VBox items="{localUIModel>/request/_testResults}">
                                <HBox>
                                    <Text text="{localUIModel>name}"/>
                                    <Text text="{localUIModel>result}"/>
                                </HBox>
                            </VBox>
                                
                            
                </Panel>

                <!-- RESPONSE HEADER -->
                <Panel expandable="true"
                       expanded="true"
                       class="sapUiNoContentPadding"
                        >
                        <headerToolbar>
                          <Toolbar design="Transparent" height="3rem">
                           <Text text="Response Headers ({localUIModel>/request/mProperties/responseHeaders/length})"/>
                         </Toolbar>
                        </headerToolbar>
                    <custom:AceEditor width="100%" height="auto"
                                      mode="text"
                                      readOnly="true"
                                      value="{localUIModel>/request/mProperties/responseHeaders}"
                                      id="superEditor3"
                                      autoHeightMode="true"
                                      enableWrapMode="true"
                            />
                </Panel>


                <!-- RESPONSE BODY -->
                <Panel expandable="true"
                       expanded="true"
                       class="sapUiNoContentPadding"
                       >
                       <headerToolbar>
                         <Toolbar design="Transparent" height="3rem">
                          <Text text="Response Body ({localUIModel>/request/mProperties/responseBody/length})"/>
                        </Toolbar>
                       </headerToolbar>
                    <VBox>
                        <SegmentedButton 
                                         select="onResponseBodyFormat"
                                         id="idButtonResponseFormat">
                            <Button text="XML" id="idButtonResponseXML"/>
                            <Button text="JSON" id="idButtonResponseJSON"/>
                            <Button text="HTML" id="idButtonResponseHTML"/>
                            <Button text="RAW" id="idButtonResponseRAW"/>
                        </SegmentedButton>
                    </VBox>
                    <custom:AceEditor width="100%" height="auto" class="projectXAceNoScroll"
                                      mode="{localUIModel>/responseBodyDisplayMode}"
                                      readOnly="true"
                                      value="{localUIModel>/responseBodyFormatted}"
                                      id="superEditor2"
                                      autoHeightMode="true"
                                      enableWrapMode="true"
                            />
                </Panel>
            </ScrollContainer>
        </content>
    </Page>
</mvc:View>
